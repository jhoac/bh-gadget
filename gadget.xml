<?xml version="1.0" encoding="UTF-8" ?> 
<Module>
    <ModulePrefs title="Bullhorn"> 
        <Require feature="dynamic-height"/>
        <Optional feature="google.calendar-0.5.read"/>
    </ModulePrefs> 
    <Content type="html">
        <![CDATA[
            <html>
                <style>
                    div > span { border-bottome: 1px solid; }
                </style>
                <body>
                    <div id="gadgetBody">Emails:</div>
                    <div id="record"></div>
                    <script>
                        function subscribeEventCallback(calendarEvent) {
                            var record,
                                recordSection = document.getElementById("record");
                            if (calendarEvent) {
                                while(recordSection.hasChildNodes()) {
                                    recordSection.removeChild(recordSection.lastChild);
                                }

                                for (var i = 0; i < calendarEvent.attendeeCount; i++) {
                                    record = document.createElement('span');
                                    record.id = 'record' + i;
                                    record.className = 'record';
                                    record.appendChild(document.createTextNode(calendarEvent.attendees[i].email + "\n"));
                                    recordSection.appendChild(record);
                                }
                                gadgets.window.adjustHeight();
                            }
                        };
                        google.calendar.read.subscribeToEvents(subscribeEventCallback);
                    </script>
                </body>
            </html>
        ]]>
    </Content> 
</Module>
